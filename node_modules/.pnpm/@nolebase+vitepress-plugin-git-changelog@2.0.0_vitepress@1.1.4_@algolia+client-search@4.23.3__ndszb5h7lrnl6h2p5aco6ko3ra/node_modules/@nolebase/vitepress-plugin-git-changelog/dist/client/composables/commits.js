"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useCommits = useCommits;
var _vue = require("vue");
var _virtualNolebaseGitChangelog = _interopRequireDefault(require("virtual:nolebase-git-changelog"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function useCommits(pageData) {
  const gitChangelog = (0, _vue.ref)(_virtualNolebaseGitChangelog.default);
  if (!gitChangelog.value) gitChangelog.value = {
    commits: []
  };
  return {
    commits: (0, _vue.computed)(() => {
      const currentPath = (0, _vue.toValue)(pageData.value.filePath);
      const preCommits = gitChangelog.value.commits;
      const commits = preCommits.filter(c => c.path === currentPath) || [];
      return commits.filter((commit, index) => {
        if (commit.tag && (!commits[index + 1] || commits[index + 1]?.tag)) return false;
        return true;
      });
    }),
    update(data) {
      gitChangelog.value = {
        commits: data
      };
    }
  };
}